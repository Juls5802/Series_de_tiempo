<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis de series de tiempo - 2&nbsp; Análisis del consumo de energía de la empresa PJM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./Descriptivo Dian (2).html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Descriptivo Energia.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análisis del consumo de energía de la empresa PJM</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis de series de tiempo</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Descriptivo Dian (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Análisis descriptivo del recaudo de impuestos internos por la DIAN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Descriptivo Energia.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análisis del consumo de energía de la empresa PJM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#estabilización-de-la-varianza-marginal" id="toc-estabilización-de-la-varianza-marginal" class="nav-link active" data-scroll-target="#estabilización-de-la-varianza-marginal"><span class="header-section-number">2.1</span> Estabilización de la varianza marginal</a></li>
  <li><a href="#estimación-de-la-tendencia" id="toc-estimación-de-la-tendencia" class="nav-link" data-scroll-target="#estimación-de-la-tendencia"><span class="header-section-number">2.2</span> Estimación de la tendencia</a>
  <ul class="collapse">
  <li><a href="#tendencia-lineal" id="toc-tendencia-lineal" class="nav-link" data-scroll-target="#tendencia-lineal"><span class="header-section-number">2.2.1</span> Tendencia lineal</a></li>
  <li><a href="#tendencia-con-promedios-móviles" id="toc-tendencia-con-promedios-móviles" class="nav-link" data-scroll-target="#tendencia-con-promedios-móviles"><span class="header-section-number">2.2.2</span> Tendencia con promedios móviles</a></li>
  <li><a href="#tendencia-con-diferenciación" id="toc-tendencia-con-diferenciación" class="nav-link" data-scroll-target="#tendencia-con-diferenciación"><span class="header-section-number">2.2.3</span> Tendencia con diferenciación</a></li>
  <li><a href="#comparación-de-los-acf" id="toc-comparación-de-los-acf" class="nav-link" data-scroll-target="#comparación-de-los-acf"><span class="header-section-number">2.2.4</span> Comparación de los ACF</a></li>
  </ul></li>
  <li><a href="#estimación-de-la-estacionalidad" id="toc-estimación-de-la-estacionalidad" class="nav-link" data-scroll-target="#estimación-de-la-estacionalidad"><span class="header-section-number">2.3</span> Estimación de la estacionalidad</a>
  <ul class="collapse">
  <li><a href="#detección-de-estacionalidad" id="toc-detección-de-estacionalidad" class="nav-link" data-scroll-target="#detección-de-estacionalidad"><span class="header-section-number">2.3.1</span> Detección de estacionalidad</a></li>
  <li><a href="#periodograma" id="toc-periodograma" class="nav-link" data-scroll-target="#periodograma"><span class="header-section-number">2.3.2</span> Periodograma</a></li>
  <li><a href="#estimación" id="toc-estimación" class="nav-link" data-scroll-target="#estimación"><span class="header-section-number">2.3.3</span> Estimación</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análisis del consumo de energía de la empresa PJM</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Según lo observado en la serie de tiempo, visualmente se tiene:</p>
<ul>
<li><strong>Heterocedasticidad marginal:</strong> Se puede observar que la varianza de cada instante en la serie es casi la misma. Al parecer no es necesario estabilizar la varianza.</li>
<li><strong>Tendencia:</strong> A simple vista se observa que, a medida que pasa el tiempo la serie oscila al rededor del mismo valor, por lo tanto, no es necesario estimar la tendencia.</li>
<li><strong>Componente estacional:</strong> Se observan algunos patrones que se repiten con cierta periodicidad, lo cual hace que sea necesario observar la posible presencia de componente estacional y posteriormente estimarla.</li>
</ul>
<section id="estabilización-de-la-varianza-marginal" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="estabilización-de-la-varianza-marginal"><span class="header-section-number">2.1</span> Estabilización de la varianza marginal</h2>
<p>Como se observa en la gráfica de la serie de tiempo no es necesario realizar una estabilización de la varianza para continuar con el análisis descriptivo, sin embargo, para comprobar esto, se hace una transformación de Box-cox para ver que tanto se estabiliza la varianza. En la <a href="#fig-boxcox1energia">Figura&nbsp;<span>2.1</span></a> se observa que se sugiere una transformación dado que 1 no está contenido en el intervalo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">boxcox</span>(<span class="fu">lm</span>(energia2 <span class="sc">~</span> <span class="dv">1</span>),<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">50</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxcox1energia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-boxcox1energia-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.1: Gráfico de la verosimilitud en función del hiperparámetro lambda.</figcaption>
</figure>
</div>
</div>
</div>
<p>En la siguiente salida se puede ver que el <span class="math inline">\(\lambda\)</span> sugerido es <span class="math inline">\(-0.25\)</span>, como es un número negativo, se procede a hacer la transformación Box-Cox usando logaritmo natural.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>forecast<span class="sc">::</span><span class="fu">BoxCox.lambda</span>(energia2, <span class="at">method =</span><span class="st">"loglik"</span>,<span class="at">lower =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.25</code></pre>
</div>
</div>
<p>En la <a href="#fig-boxcox1lenergia">Figura&nbsp;<span>2.2</span></a> a continuación se muestra que la serie en escala logarítmica nuevamente no tiene la varianza estabilizada, dado que no se contiene al 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lenergia2<span class="ot">=</span><span class="fu">log</span>(energia2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">boxcox</span>(<span class="fu">lm</span>(lenergia2 <span class="sc">~</span> <span class="dv">1</span>),<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length =</span>  <span class="dv">50</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boxcox1lenergia" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-boxcox1lenergia-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.2: Gráfico de la verosimilitud para la serie en escala logarítmica, en función del hiperparámetro lambda.</figcaption>
</figure>
</div>
</div>
</div>
<p>Además, se puede notar en la <a href="#fig-sinconboxcoxenerg">Figura&nbsp;<span>2.3</span></a> , que no hay una diferencia significativa entre la serie transformada y no transformada. Por lo que el análisis descriptivo se continúa usando los datos originales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energia2,<span class="at">main=</span><span class="st">"Serie energía sin Transformar"</span>,<span class="at">cex.main=</span><span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lenergia2,<span class="at">main=</span><span class="st">"Serie energía con Transformación BoxCox"</span>,<span class="at">cex.main=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sinconboxcoxenerg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-sinconboxcoxenerg-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.3: Serie original y serie con transformación logarítmica.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="estimación-de-la-tendencia" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="estimación-de-la-tendencia"><span class="header-section-number">2.2</span> Estimación de la tendencia</h2>
<p>Como se observa en la gráfica de la serie de tiempo no es necesario realizar una estimación de la tendencia para continuar con el análisis descriptivo, sin embargo, se hace una estimación preliminar usando varios métodos, con el fin de comprobar que la serie sin tendencia no varía mucho.</p>
<section id="tendencia-lineal" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="tendencia-lineal"><span class="header-section-number">2.2.1</span> Tendencia lineal</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creación del objeto tibble</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>energia_1<span class="ot">=</span>energia <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(rev)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Fechas<span class="ot">=</span><span class="fu">as.Date</span>(energia_1<span class="sc">$</span>fecha)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>energia_xts<span class="ot">=</span><span class="fu">xts</span>(<span class="at">x =</span> energia_1<span class="sc">$</span>Energia,<span class="at">frequency =</span> <span class="fl">365.25</span>,<span class="at">order.by =</span> Fechas)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Creación objeto tssible a partir del objeto tibble</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>df_energia<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Energia=</span>energia_1<span class="sc">$</span>Energia,<span class="at">fecha=</span>energia_1<span class="sc">$</span>fecha)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>tbl_energia<span class="ot">=</span><span class="fu">tibble</span>(df_energia)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>tbl_energia_format_fecha<span class="ot">=</span>tbl_energia</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>tsbl_energia<span class="ot">=</span><span class="fu">as_tsibble</span>(tbl_energia_format_fecha,<span class="at">index=</span>fecha)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la siguiente salida se presenta el ajuste de una regresión lineal para estimar la tendencia. El <span class="math inline">\(R^2\)</span> indíca qué tan bien se ajusta la recta a los datos, en este caso tiene un valor de <span class="math inline">\(0.058\)</span>, por lo que sugiere que no hay tendencia lineal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis de tendencia con regresion simple</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_e<span class="ot">&lt;-</span><span class="fu">lm</span>(energia2<span class="sc">~</span><span class="fu">time</span>(energia2),<span class="at">na.action=</span><span class="cn">NULL</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = energia2 ~ time(energia2), na.action = NULL)

Residuals:
    Min      1Q  Median      3Q     Max 
-137653  -34064   -5533   31129  179275 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    6128528.2   325172.5   18.85   &lt;2e-16 ***
time(energia2)   -2862.7      161.7  -17.70   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 45920 on 5052 degrees of freedom
Multiple R-squared:  0.05841,   Adjusted R-squared:  0.05823 
F-statistic: 313.4 on 1 and 5052 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>En la <a href="#fig-serietiempoenergiareglineal">Figura&nbsp;<span>2.4</span></a> se presenta la serie de tiempo de la energía con la estimación lineal de la tendencia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energia2, <span class="at">main=</span><span class="st">"Serie de tiempo de la energía diaria de una empresa estadounidense"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main=</span><span class="dv">1</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Tiempo "</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Energía consumida"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span><span class="fl">0.4</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(fit_e,<span class="at">col=</span><span class="st">"darkcyan"</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiareglineal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiareglineal-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.4: Gráfico de la serie de tiempo de la energía con la estimación lineal de la tendencia.</figcaption>
</figure>
</div>
</div>
</div>
<p>Posteriormente, se procede a eliminar la tendencia lineal, como se puede ver en la <a href="#fig-serietiempoenergiasintendreglineal">Figura&nbsp;<span>2.5</span></a> .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminación de la tendencia con la predicción la recta</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ElimiTendenerg<span class="ot">&lt;-</span>energia2<span class="sc">-</span><span class="fu">predict</span>(fit_e)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ElimiTendenerg,<span class="at">main=</span><span class="st">"Serie energía sin tendencia"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main=</span><span class="fl">1.3</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Tiempo"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Consumo de energía"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span><span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiasintendreglineal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiasintendreglineal-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.5: Gráfico de la serie de tiempo de la energía sin tendencia estimada con regresión lineal.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="tendencia-con-promedios-móviles" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="tendencia-con-promedios-móviles"><span class="header-section-number">2.2.2</span> Tendencia con promedios móviles</h3>
<p>En la <a href="#fig-serietiempoenergiaprommovil">Figura&nbsp;<span>2.6</span></a> , se muestra un ajuste de la tendencia con promedios móviles, como se puede ver, aparentemente hay una sobrestimación de la tendencia, ya que muestra comportamientos que no son tan visibles en la serie de tiempo original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descomposición filtro de promedios móviles</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>energia_decompo<span class="ot">=</span><span class="fu">decompose</span>(energia2)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energia_decompo)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiaprommovil" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiaprommovil-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.6: Gráfico de la serie de tiempo de la energía sin tendencia estimada con promedios móviles.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="tendencia-con-diferenciación" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="tendencia-con-diferenciación"><span class="header-section-number">2.2.3</span> Tendencia con diferenciación</h3>
<p>En la <a href="#fig-serietiempoenergiadiff">Figura&nbsp;<span>2.7</span></a> se presentan los gráficos de las series sin tendencia, estimada con regresión lineal y con diferenciación respectivamente, se puede notar que la serie sin tendencia estimada con diferenciación impide ver los ciclos que se ven en la serie original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tsibble_energia<span class="ot">&lt;-</span><span class="fu">as_tsibble</span>(energia2)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(fit_e), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">main=</span><span class="st">"Sin tendencia lineal"</span>) </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(energia2), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">main=</span><span class="st">"Primera Diferencia"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiadiff" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiadiff-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.7: Gráfico de la serie de tiempo de la energía sin tendencia estimada con regresión lineal y diferenciación.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="comparación-de-los-acf" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="comparación-de-los-acf"><span class="header-section-number">2.2.4</span> Comparación de los ACF</h3>
<p>En la <a href="#fig-serietiempoenergiaacf">Figura&nbsp;<span>2.8</span></a> se puede notar un descenso rápido hacia 0 para las series original y sin tendencia estimada con regresión lineal, mientras que para la serie sin tendencia estimada con diferenciación, se puede apreciar mejor el ciclo estacional de aproximadamente 7 días.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos de los ACF</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(energia2, <span class="dv">60</span>, <span class="at">main=</span><span class="st">"ACF energia"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">resid</span>(fit_e), <span class="dv">60</span>, <span class="at">main=</span><span class="st">"ACF Sin tendencia"</span>) </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(energia2), <span class="dv">60</span>, <span class="at">main=</span><span class="st">"ACF Primera Diferencia"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiaacf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiaacf-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.8: Gráficos de autocorrelación para la serie original, sin tendencia estimada con regresión lineal y con la primera diferencia.</figcaption>
</figure>
</div>
</div>
</div>
<p>Si bien se estima la tendencia con diferentes métodos, se decide trabajar con los datos originales, ya que no hay un cambio significativo en la serie cuando se elimina la tendencia.</p>
</section>
</section>
<section id="estimación-de-la-estacionalidad" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="estimación-de-la-estacionalidad"><span class="header-section-number">2.3</span> Estimación de la estacionalidad</h2>
<section id="detección-de-estacionalidad" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="detección-de-estacionalidad"><span class="header-section-number">2.3.1</span> Detección de estacionalidad</h3>
<p>En la <a href="#fig-serietiempoenergiaretardos">Figura&nbsp;<span>2.9</span></a> se puede observar el gráfico de retardos para la serie original, es evidente que hay una asociación lineal más fuerte para el primer retardo, aunque para los demás retardos también se encuentra asociación lineal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de retardos</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">lag1.plot</span>(energia2, <span class="dv">7</span>,<span class="at">corr=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiaretardos" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiaretardos-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.9: Gráficos de retardos para la serie de consumo de energía.</figcaption>
</figure>
</div>
</div>
</div>
<p>En la <a href="#fig-serietiempoenergiaretardosdiff">Figura&nbsp;<span>2.10</span></a> se puede ver el gráfico de retardos para la serie sin tendencia estimada con diferenciación, aquí no es visible ninguna asociación lineal fuerte entre los rezagos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de retardos</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>astsa<span class="sc">::</span><span class="fu">lag1.plot</span>(<span class="fu">diff</span>(energia2), <span class="dv">7</span>,<span class="at">corr=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiaretardosdiff" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiaretardosdiff-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.10: Gráficos de retardos para la serie sin tendencia estimada con diferenciación.</figcaption>
</figure>
</div>
</div>
</div>
<p>Adicionalmente se calcula el índice AMI, el cual se puede visualizar en la <a href="#fig-serietiempoenergiaami">Figura&nbsp;<span>2.11</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Indice AMI </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tseriesChaos<span class="sc">::</span><span class="fu">mutual</span>(energia2, <span class="at">partitions =</span> <span class="dv">50</span>, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">plot=</span><span class="cn">TRUE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiaami" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiaami-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.11: Gráfico del promedio de información mutua.</figcaption>
</figure>
</div>
</div>
</div>
<p>Es posible ver que el primer rezago reduce el estado de incertidumbre para la observación en el tiempo <span class="math inline">\(t\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>energiasss<span class="ot">&lt;-</span><span class="fu">rbind</span>(energia,<span class="fu">c</span>(<span class="st">"2018-08-03"</span>,<span class="dv">0</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>energia_df1<span class="ot">&lt;-</span>energiasss</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>energia_df1<span class="sc">$</span>time <span class="ot">=</span> <span class="fu">as.POSIXct</span>(energia_df1<span class="sc">$</span>fecha, <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>energia_df<span class="ot">&lt;-</span><span class="fu">cbind</span>(energia_df1[<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],energia_df1[<span class="dv">2</span><span class="sc">:</span><span class="dv">5055</span>,<span class="dv">3</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>energia_df<span class="sc">$</span>weekday <span class="ot">&lt;-</span> <span class="fu">wday</span>(energia_df<span class="sc">$</span>time, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>energia_df<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(month.abb[<span class="fu">month</span>(energia_df<span class="sc">$</span>time)], <span class="at">levels =</span>   month.abb)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la <a href="#fig-serietiempoenergiasubseriediar">Figura&nbsp;<span>2.12</span></a> se presenta el gráfico de subseries diarias para la serie original, se puede ver que hay estacionalidad ya que el valor medio del día domingo por ejemplo, es menor al del resto de días.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de subseries semanal con datos originales</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_subseries</span>(tsbl_energia,<span class="at">y=</span>Energia,<span class="at">period=</span><span class="dv">7</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiasubseriediar" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiasubseriediar-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.12: Gráfica de subseries diarias.</figcaption>
</figure>
</div>
</div>
</div>
<p>En la <a href="#fig-serietiempoenergiasubseriean">Figura&nbsp;<span>2.13</span></a> se presenta el gráfico de subseries mensuales para la serie original, se puede ver que no hay ciclos estacionales mensuales, ya que todos tienen la misma media.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfica de subseries anual con datos originales</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_subseries</span>(tsbl_energia,<span class="at">y=</span>Energia,<span class="at">period=</span><span class="dv">12</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-serietiempoenergiasubseriean" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-serietiempoenergiasubseriean-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.13: Gráfica de subseries anuales.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="periodograma" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="periodograma"><span class="header-section-number">2.3.2</span> Periodograma</h3>
<section id="para-los-datos-originales" class="level4" data-number="2.3.2.1">
<h4 data-number="2.3.2.1" class="anchored" data-anchor-id="para-los-datos-originales"><span class="header-section-number">2.3.2.1</span> Para los datos originales</h4>
<p>En la <a href="#fig-periodorginenerg">Figura&nbsp;<span>2.14</span></a> se presenta el periodograma para la serie original, el valor del periodo donde se maximiza el periodograma es <span class="math inline">\(182.86\)</span>, es decir, aproximadamente, el ciclo es de medio año.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Periodograma Datos originales</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(energia2),<span class="at">log=</span><span class="st">'no'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>PeriodogramaEnergia2<span class="ot">=</span><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(energia2),<span class="at">log=</span><span class="st">'no'</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ubicacionenergia<span class="ot">=</span><span class="fu">which.max</span>(PeriodogramaEnergia2<span class="sc">$</span>spec)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El valor de la frecuencia donde se maximiza el periodograma para la serie es: %s"</span>,PeriodogramaEnergia2<span class="sc">$</span>freq[ubicacionenergia])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El valor de la frecuencia donde se maximiza el periodograma para la serie es: 0.00546875"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El periodo correspondiente es aproximadamente: %s"</span>,<span class="dv">1</span><span class="sc">/</span>PeriodogramaEnergia2<span class="sc">$</span>freq[ubicacionenergia])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El periodo correspondiente es aproximadamente: 182.857142857143"</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-periodorginenerg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-periodorginenerg-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.14: Periodograma para la serie original.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="para-la-serie-sin-tendencia-lineal" class="level4" data-number="2.3.2.2">
<h4 data-number="2.3.2.2" class="anchored" data-anchor-id="para-la-serie-sin-tendencia-lineal"><span class="header-section-number">2.3.2.2</span> Para la serie sin tendencia lineal</h4>
<p>En la <a href="#fig-periodlinealenerg">Figura&nbsp;<span>2.15</span></a> se presenta el periodograma para la serie sin tendencia lineal, el valor del periodo donde se maximiza el periodograma nuevamente es <span class="math inline">\(182.86\)</span>, es decir, aproximadamente, el ciclo es de medio año.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Periodograma sin tendencia lineal</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(ElimiTendenerg),<span class="at">log=</span><span class="st">'no'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>PeriodogramaEnergia2_lineal<span class="ot">=</span><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(ElimiTendenerg),<span class="at">log=</span><span class="st">'no'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ubicacionlogenergia<span class="ot">=</span><span class="fu">which.max</span>(PeriodogramaEnergia2_lineal<span class="sc">$</span>spec)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El valor de la frecuencia donde se maximiza el periodograma para la serie es: %s"</span>,PeriodogramaEnergia2_lineal<span class="sc">$</span>freq[ubicacionlogenergia])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El valor de la frecuencia donde se maximiza el periodograma para la serie es: 0.00546875"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El periodo correspondiente es aproximadamente: %s"</span>,<span class="dv">1</span><span class="sc">/</span>PeriodogramaEnergia2_lineal<span class="sc">$</span>freq[ubicacionlogenergia])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El periodo correspondiente es aproximadamente: 182.857142857143"</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-periodlinealenerg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-periodlinealenerg-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.15: Periodograma para la serie sin tendencia lineal.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="para-la-serie-sin-tendencia-usando-diferenciación" class="level4" data-number="2.3.2.3">
<h4 data-number="2.3.2.3" class="anchored" data-anchor-id="para-la-serie-sin-tendencia-usando-diferenciación"><span class="header-section-number">2.3.2.3</span> Para la serie sin tendencia usando diferenciación</h4>
<p>En la <a href="#fig-perioddiffenerg">Figura&nbsp;<span>2.16</span></a> se presenta el periodograma para la serie sin tendencia estimada usando diferenciación, el valor del periodo donde se maximiza el periodograma es <span class="math inline">\(3.5\)</span>, es decir, aproximadamente, el ciclo es de tres días.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Periodograma diferenciación</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(<span class="fu">diff</span>(energia2)),<span class="at">log=</span><span class="st">'no'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>PeriodogramaEnergia2_dif<span class="ot">=</span><span class="fu">spectrum</span>(<span class="fu">as.numeric</span>(<span class="fu">diff</span>(energia2)),<span class="at">log=</span><span class="st">'no'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ubicacionlogenergia<span class="ot">=</span><span class="fu">which.max</span>(PeriodogramaEnergia2_dif<span class="sc">$</span>spec)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El valor de la frecuencia donde se maximiza el periodograma para la serie es: %s"</span>,PeriodogramaEnergia2_dif<span class="sc">$</span>freq[ubicacionlogenergia])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El valor de la frecuencia donde se maximiza el periodograma para la serie es: 0.2857421875"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"El periodo correspondiente es aproximadamente: %s"</span>,<span class="dv">1</span><span class="sc">/</span>PeriodogramaEnergia2_dif<span class="sc">$</span>freq[ubicacionlogenergia])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "El periodo correspondiente es aproximadamente: 3.49965823650034"</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-perioddiffenerg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-perioddiffenerg-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.16: Periodograma para la serie sin tendencia usando diferenciación.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="estimación" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="estimación"><span class="header-section-number">2.3.3</span> Estimación</h3>
<p>Ahora procederemos a estimar el ciclo estacional que se observa en esta serie de tiempo, es importante resaltar que con ayuda de los graficos exploratorios y el periodograma se observo que el periodo de la componente estacional es <span class="math inline">\(s=12\)</span>, por lo tanto utilizaremos en primer lugar componentes de fourier, esto teniendo en cuenta que se aprecia que la componente estacional sigue un comportamiento deterministico y posiblemente sinosoidal. Teniendo lo anterior en cuenta el modelo viene dado por: <span class="math display">\[\begin{align*} x_t&amp;= ∑_{i=1}^k a_icos(k𝜔t)+b_isen(k𝜔t) + w_t \\ \end{align*}\]</span> Donde <span class="math inline">\(k\)</span> corresponderá al orden de la expansión en series de Fourier y los coeficientes <span class="math inline">\(a_i\)</span> y <span class="math inline">\(b_i\)</span> con <span class="math inline">\(i=1,...,k\)</span> serán estimados a través del método de mínimos cuadrados. El cálculo de esta componente se muestra a continuación considerando un orden <span class="math inline">\(k=3\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>PeriodogramaEnergia2<span class="sc">$</span>freq[ubicacionenergia]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>sin_est<span class="ot">=</span><span class="fu">diff</span>(energia2,<span class="at">lag=</span><span class="fu">round</span>(s),<span class="at">differences=</span><span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(sin_est, <span class="at">main=</span><span class="st">"Serie sin estacionalidad"</span>, <span class="at">ylab=</span><span class="st">''</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Descriptivo-Energia_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Frecuencia angular w=2*pi/s</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>frec_ang<span class="ot">=</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">183</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="ot">=</span>energia</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Fourier k=1 </span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="sc">$</span>sin <span class="ot">=</span> <span class="fu">sin</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">*</span>frec_ang))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="sc">$</span>cos <span class="ot">=</span> <span class="fu">cos</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">*</span>frec_ang))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Fourier k=2 </span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="sc">$</span>sin2 <span class="ot">=</span> <span class="fu">sin</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>frec_ang))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="sc">$</span>cos2 <span class="ot">=</span> <span class="fu">cos</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>frec_ang))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Fourier k=3 </span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="sc">$</span>sin3 <span class="ot">=</span> <span class="fu">sin</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>)<span class="sc">*</span>(<span class="dv">3</span><span class="sc">*</span>frec_ang))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>energia_copia<span class="sc">$</span>cos3 <span class="ot">=</span> <span class="fu">cos</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5054</span>)<span class="sc">*</span>(<span class="dv">3</span><span class="sc">*</span>frec_ang))</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>linmodel_ciclo1<span class="ot">&lt;-</span><span class="fu">lm</span>(Energia<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>sin<span class="sc">+</span>cos,<span class="at">data=</span>energia_copia)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>linmodel_ciclo2<span class="ot">&lt;-</span><span class="fu">lm</span>(Energia<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>sin<span class="sc">+</span>cos<span class="sc">+</span>sin2<span class="sc">+</span>cos2,<span class="at">data=</span>energia_copia)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>linmodel_ciclo3<span class="ot">&lt;-</span><span class="fu">lm</span>(Energia<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>sin<span class="sc">+</span>cos<span class="sc">+</span>sin2<span class="sc">+</span>cos2<span class="sc">+</span>sin3<span class="sc">+</span>cos3,<span class="at">data=</span>energia_copia)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linmodel_ciclo1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Energia ~ 1 + sin + cos, data = energia_copia)

Residuals:
    Min      1Q  Median      3Q     Max 
-123583  -25009    -763   24258  145198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 371981.5      540.3  688.43   &lt;2e-16 ***
sin         -21616.9      765.2  -28.25   &lt;2e-16 ***
cos         -32486.6      763.0  -42.58   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 38410 on 5051 degrees of freedom
Multiple R-squared:  0.3413,    Adjusted R-squared:  0.3411 
F-statistic:  1309 on 2 and 5051 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linmodel_ciclo2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Energia ~ 1 + sin + cos + sin2 + cos2, data = energia_copia)

Residuals:
    Min      1Q  Median      3Q     Max 
-121273  -25065    -578   23895  142064 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 371998.9      537.7 691.805  &lt; 2e-16 ***
sin         -21669.2      761.5 -28.455  &lt; 2e-16 ***
cos         -32508.8      759.4 -42.810  &lt; 2e-16 ***
sin2          -732.1      760.4  -0.963    0.336    
cos2         -5398.2      760.4  -7.099 1.43e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 38220 on 5049 degrees of freedom
Multiple R-squared:  0.348, Adjusted R-squared:  0.3475 
F-statistic: 673.6 on 4 and 5049 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linmodel_ciclo3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Energia ~ 1 + sin + cos + sin2 + cos2 + sin3 + cos3, 
    data = energia_copia)

Residuals:
    Min      1Q  Median      3Q     Max 
-122150  -24871    -895   23895  143573 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 372002.2      537.1 692.636  &lt; 2e-16 ***
sin         -21672.6      760.6 -28.493  &lt; 2e-16 ***
cos         -32522.7      758.5 -42.879  &lt; 2e-16 ***
sin2          -701.3      759.6  -0.923 0.355904    
cos2         -5400.4      759.5  -7.110 1.32e-12 ***
sin3          1096.1      759.1   1.444 0.148814    
cos3          2630.0      759.9   3.461 0.000543 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 38180 on 5047 degrees of freedom
Multiple R-squared:  0.3498,    Adjusted R-squared:  0.349 
F-statistic: 452.5 on 6 and 5047 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>results_ciclo1<span class="ot">=</span>linmodel_ciclo1<span class="sc">$</span>fitted.values</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>results_ciclo1<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(results_ciclo1)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>results_ciclo_ts1<span class="ot">&lt;-</span><span class="fu">ts</span>(results_ciclo1,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">2004</span>,<span class="dv">10</span>,<span class="dv">01</span>),<span class="at">frequency=</span><span class="fl">365.25</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>results_ciclo2<span class="ot">=</span>linmodel_ciclo2<span class="sc">$</span>fitted.values</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>results_ciclo2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(results_ciclo2)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>results_ciclo_ts2<span class="ot">&lt;-</span><span class="fu">ts</span>(results_ciclo2,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">2004</span>,<span class="dv">10</span>,<span class="dv">01</span>),<span class="at">frequency=</span><span class="fl">365.25</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>results_ciclo3<span class="ot">=</span>linmodel_ciclo3<span class="sc">$</span>fitted.values</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>results_ciclo3<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(results_ciclo3)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>results_ciclo_ts3<span class="ot">&lt;-</span><span class="fu">ts</span>(results_ciclo3,<span class="at">start=</span><span class="fu">c</span>(<span class="dv">2004</span>,<span class="dv">10</span>,<span class="dv">01</span>),<span class="at">frequency=</span><span class="fl">365.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En la <span class="quarto-unresolved-ref">?fig-energestacionalidad</span> se presenta la serie original con la estimación de la componente estacional via componentes de Fourier y la serie sin estacionalidad. Se puede notar que las componentes de Fourier logran captar bien es cíclo estacional que tiene la serie, AGREGAR MAIS COZINHAS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Series original</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energia2, <span class="at">main=</span><span class="st">"Serie de tiempo del consumo de energía"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main=</span><span class="fl">1.3</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Tiempo "</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Energía consumida"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span><span class="fl">0.4</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimación de la estacionalidad</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(results_ciclo_ts1,<span class="at">col=</span><span class="st">"darkcyan"</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(results_ciclo_ts2,<span class="at">col=</span><span class="st">"magenta"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(results_ciclo_ts3,<span class="at">col=</span><span class="st">"orange"</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Serie sin estacionalidad</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energia2<span class="sc">-</span>results_ciclo_ts3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-energestacionalidad-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-energestacionalidad-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.17: Serie original con estamación de la componente estacional y serie sin estacionalidad.</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-energestacionalidad-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Descriptivo-Energia_files/figure-html/fig-energestacionalidad-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figura&nbsp;2.18: Serie original con estamación de la componente estacional y serie sin estacionalidad.</figcaption>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Descriptivo Dian (2).html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Análisis descriptivo del recaudo de impuestos internos por la DIAN</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>