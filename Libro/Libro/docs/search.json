[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Análisis de series de tiempo",
    "section": "",
    "text": "Introducción"
  },
  {
    "objectID": "index.html#esquina",
    "href": "index.html#esquina",
    "title": "Análisis de series de tiempo",
    "section": "Esquina",
    "text": "Esquina\nEste trabajo realiza un análisis de dos bases de datos: Recaudo de impuestos internos por la DIAN para los años 2000 a 2023 y consumo de energía por horas de la organización regional de transmisión PJM Interconnection para los años 2004 a 2018. El análisis se desarrolla de forma estadística, realizando la parte descriptiva con su correspondiente interpretación."
  },
  {
    "objectID": "index.html#análisis-del-recaudo-de-impuestos-internos-por-la-dian",
    "href": "index.html#análisis-del-recaudo-de-impuestos-internos-por-la-dian",
    "title": "Análisis de series de tiempo",
    "section": "Análisis del recaudo de impuestos internos por la DIAN",
    "text": "Análisis del recaudo de impuestos internos por la DIAN\nLa DIAN es la entidad encargada de administrar y recaudar los impuestos internos y aduaneros en el país. El recaudo de impuestos internos que realiza la DIAN cada mes se refiere a la suma total de los impuestos nacionales recaudados dentro del territorio colombiano durante ese período mensual. Los impuestos internos son aquellos que se aplican a las actividades económicas y transacciones que ocurren dentro del país, los cuales pueden incluir: IVA, impuesto de renta y complementarios, impuesto de timbre, impuesto de consumo, impuesto a la riqueza, impuesto predial, ICA, entre otros.\nCon el proyecto se busca estudiar esta serie de tiempo para ver como es el comportamiento de los impuestos internos de Colombia a lo largo de los años, por ejemplo, encontrar patrones y observar qué tanto han aumentado dichos impuestos.\nA continuación se presenta la manera en que se realiza la carga de los datos y un vistazo preliminar de la serie de tiempo en la Figura 1 .\n\n# Carga de la base de datos\ndian&lt;-read_excel(\"dian.xlsx\", range=\"A7:C313\", sheet = \"Rec mensual a junio 2023\" )\naños&lt;-2000:2023\ndian&lt;-dplyr::filter(dian,Año %in% años)\ncolnames(dian)&lt;-c(\"Año\",\"Mes\",\"Impuestos\")\ndian$fecha&lt;-as.Date(paste(dian$Año, dian$Mes, \"1\", sep = \"-\"), format = \"%Y-%B-%d\")\ndian&lt;-dian[,3:4]\n\n# Gráfico de la serie de tiempo\ndian2&lt;-ts(dian$Impuestos,start=c(2000,01),frequency=12)\nplot(dian2, main=\"Serie de tiempo del recaudo mensual interno\",\n     cex.main=1.3,\n     xlab=\"Tiempo\",\n     ylab=\"Recaudo interno\",\n     cex.lab=0.4)\n\n\n\n\nFigura 1: Gráfico de la serie de tiempo de la DIAN."
  },
  {
    "objectID": "Descriptivo Dian.html",
    "href": "Descriptivo Dian.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n\nKnuth, Donald E. 1984. «Literate Programming». Comput. J. 27 (2): 97-111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "Descriptivo Energia.html",
    "href": "Descriptivo Energia.html",
    "title": "2  Análisis descriptivo Energía",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "Descriptivo Dian.html#estabilización-de-la-varianza-marginal",
    "href": "Descriptivo Dian.html#estabilización-de-la-varianza-marginal",
    "title": "1  Análisis descriptivo del recaudo de impuestos internos por la DIAN",
    "section": "1.1 Estabilización de la varianza marginal",
    "text": "1.1 Estabilización de la varianza marginal\nComo se observa en la gráfica de la serie de tiempo es necesario realizar una estabilización de la varianza para continuar con el análisis descriptivo, para esto se utilizó una transformación de Box-cox.\n\nMASS::boxcox(lm(dian2 ~ 1),seq(-5, 5, length = 50)) ##Notese que no captura al 1\n\n\n\nforecast::BoxCox.lambda(dian2, method =\"loglik\",\n                        lower = -1, upper = 3)#Entrega el valor de lambda (0.1), cercano a cero o sea que vale la pena pensar en una transformación logaritmica.\n\n[1] 0.1\n\nplot(forecast::BoxCox(dian2,lambda=0.1))"
  },
  {
    "objectID": "index.html#análisis-del-consumo-de-energía-de-la-empresa-pjm",
    "href": "index.html#análisis-del-consumo-de-energía-de-la-empresa-pjm",
    "title": "Análisis de series de tiempo",
    "section": "Análisis del consumo de energía de la empresa PJM",
    "text": "Análisis del consumo de energía de la empresa PJM\nLa empresa PJM es una organización de transmisión regional que coordina el movimiento de electricidad mayorista en la totalidad, o parte, de 13 estados y el Distrito de Columbia.\nEl análisis del consumo de energía es esencial para mejorar la eficiencia operativa, reducir costos, cumplir con regulaciones y promover la sostenibilidad, por lo cual, este proyecto analiza la serie de tiempo con el fin de encontrar variaciones en el consumo de energía de los 13 estados y el Distrito de Columbia a lo largo del tiempo, así como también descubrir posibles patrones.\nA continuación se presenta la manera en que se realiza la carga de los datos y un vistazo preliminar de la serie de tiempo en la Figura 2 .\n\n# Carga de la base de datos\nAEP_hourly&lt;-read.csv(\"AEP_hourly.csv\")\nAEP_hourly$Datetime&lt;-as.POSIXct(AEP_hourly$Datetime, format = \"%Y-%m-%d %H:%M:%S\")\nAEP_hourly$fecha&lt;-as.Date(AEP_hourly$Datetime)\n\nenergia &lt;- AEP_hourly %&gt;%\n  group_by(fecha) %&gt;%\n  summarise(Energia = sum(AEP_MW))\nenergia&lt;-energia[-5055,]\n\n# Gráfico de la serie de tiempo\nenergia2&lt;-ts(energia$Energia,start=c(2004,10,01),frequency=365.25)\nplot(energia2, main=\"Serie de tiempo de la energía diaria de una empresa estadounidense\",\n     cex.main=1,\n     xlab=\"Tiempo \",\n     ylab=\"Energía consumida\",\n     cex.lab=0.4)\n\n\n\n\nFigura 2: Gráfico de la serie de tiempo de la energía."
  },
  {
    "objectID": "index.html#sobre-el-trabajo",
    "href": "index.html#sobre-el-trabajo",
    "title": "Análisis de series de tiempo",
    "section": "Sobre el trabajo",
    "text": "Sobre el trabajo\nEste trabajo realiza un análisis de dos bases de datos: Recaudo de impuestos internos por la DIAN para los años 2000 a 2023 y consumo de energía por horas de la organización regional de transmisión PJM Interconnection para los años 2004 a 2018. El análisis se desarrolla de forma estadística, realizando la parte descriptiva con su correspondiente interpretación."
  },
  {
    "objectID": "Descriptivo Energia.html#estabilización-de-la-varianza-marginal",
    "href": "Descriptivo Energia.html#estabilización-de-la-varianza-marginal",
    "title": "2  Análisis del consumo de energía de la empresa PJM",
    "section": "2.1 Estabilización de la varianza marginal",
    "text": "2.1 Estabilización de la varianza marginal\nComo se observa en la gráfica de la serie de tiempo no es necesario realizar una estabilización de la varianza para continuar con el análisis descriptivo, sin embargo, para comprobar esto, se hace una transformación de Box-cox para ver que tanto se estabiliza la varianza. En la Figura 2.1 se observa que se sugiere una transformación, dado que 1 no está contenido en el intervalo.\n\nMASS::boxcox(lm(energia2 ~ 1),seq(-5, 5, length = 50))\nabline(v = 1, col = \"red\", lty = 2)\n\n\n\n\nFigura 2.1: Gráfico de la verosimilitud en función del hiperparámetro lambda.\n\n\n\n\nEn la siguiente salida se puede ver que el \\(\\lambda\\) sugerido es \\(-0.25\\), como es un número negativo, se procede a hacer la transformación Box-Cox usando logaritmo natural.\n\nforecast::BoxCox.lambda(energia2, method =\"loglik\",lower = -1, upper = 3)\n\n[1] -0.25\n\n\nEn la Figura 2.2 a continuación se muestra que la serie en escala logarítmica nuevamente no tiene la varianza estabilizada, dado que no se contiene al 1.\n\nlenergia2=log(energia2)\nMASS::boxcox(lm(lenergia2 ~ 1),seq(-5, 5, length =  50))\nabline(v = 1, col = \"red\", lty = 2)\n\n\n\n\nFigura 2.2: Gráfico de la verosimilitud para la serie en escala logarítmica, en función del hiperparámetro lambda.\n\n\n\n\nAdemás, se puede notar que, en la Figura 2.3 , que no hay una diferencia significativa entre la serie transformada y no transformada. Por lo que el análisis descriptivo se continua usando los datos originales.\n\npar(mar = c(1,1,1,1))\npar(mfrow=c(2,1),mar=c(3,3,3,3))\nplot(energia2,main=\"Serie energía sin Transformar\",cex.main=1)\nplot(lenergia2,main=\"Serie energía con Transformación BoxCox\",cex.main=1)\n\n\n\n\nFigura 2.3: Serie original y serie con transformación logarítmica."
  },
  {
    "objectID": "Descriptivo Energia.html#estimación-preliminar-de-la-tendencia",
    "href": "Descriptivo Energia.html#estimación-preliminar-de-la-tendencia",
    "title": "2  Análisis del consumo de energía de la empresa PJM",
    "section": "2.2 Estimación preliminar de la tendencia",
    "text": "2.2 Estimación preliminar de la tendencia\nComo se observa en la gráfica de la serie de tiempo no es necesario realizar una estimación de la tendencia para continuar con el análisis descriptivo, sin embargo, se hace una estimación preliminar usando varios métodos.\n\n2.2.1 Tendencia lineal\n\n# Creación del objeto tibble\nenergia_1=energia %&gt;% map_df(rev)\nFechas=as.Date(energia_1$fecha)\nenergia_xts=xts(x = energia_1$Energia,frequency = 365.25,order.by = Fechas)\n\n# Creación objeto tssible a partir del objeto tibble\ndf_energia=data.frame(Energia=energia_1$Energia,fecha=energia_1$fecha)\ntbl_energia=tibble(df_energia)\ntbl_energia_format_fecha=tbl_energia\ntsbl_energia=as_tsibble(tbl_energia_format_fecha,index=fecha)\n\nEn la siguiente salida se presenta el ajuste de una regresión lineal para estimar la tendencia. Como el \\(R^2\\) es \\(0.058\\), se sugiere que no hay tendencia.\n\n# Análisis de tendencia con regresion simple\nsummary(fit_e&lt;-lm(energia2~time(energia2),na.action=NULL))\n\n\nCall:\nlm(formula = energia2 ~ time(energia2), na.action = NULL)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-137653  -34064   -5533   31129  179275 \n\nCoefficients:\n                Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    6128528.2   325172.5   18.85   &lt;2e-16 ***\ntime(energia2)   -2862.7      161.7  -17.70   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 45920 on 5052 degrees of freedom\nMultiple R-squared:  0.05841,   Adjusted R-squared:  0.05823 \nF-statistic: 313.4 on 1 and 5052 DF,  p-value: &lt; 2.2e-16\n\n\nEn la Figura 2.4 se presenta la serie de tiempo de la energía con la estimación lineal de la tendencia.\n\nplot(energia2, main=\"Serie de tiempo de la energía diaria de una empresa estadounidense\",\n     cex.main=1,\n     xlab=\"Tiempo \",\n     ylab=\"Energía consumida\",\n     cex.lab=0.4)\nabline(fit_e,col=\"darkcyan\",lwd=2)\n\n\n\n\nFigura 2.4: Gráfico de la serie de tiempo de la energía con la estimación lineal de la tendencia.\n\n\n\n\nPosteriormente, se procede a eliminar la tendencia lineal, como se puede ver en la Figura 2.5 .\n\n# Eliminación de la tendencia con la predicción la recta\nElimiTendenerg&lt;-energia2-predict(fit_e)\nplot(ElimiTendenerg,main=\"Serie energía sin tendencia\",\n     cex.main=1.3,\n     xlab=\"Tiempo\",\n     ylab=\"Consumo de energía\",\n     cex.lab=0.4)\n\n\n\n\nFigura 2.5: Gráfico de la serie de tiempo de la energía sin tendencia estimada con regresión lineal.\n\n\n\n\n\n\n2.2.2 Tendencia con promedios móviles\nEn la Figura 2.6 , se muestra un ajuste de la tendencia con promedios móviles, como se puede ver, aparentemente hay una sobrestimación de la tendencia, ya que muestra comportamientos que no son tan visibles en la serie de tiempo original.\n\n# Descomposición filtro de promedios móviles\nenergia_decompo=decompose(energia2)\nplot(energia_decompo)\n\n\n\n\nFigura 2.6: Gráfico de la serie de tiempo de la energía sin tendencia estimada con promedios móviles.\n\n\n\n\n\n\n2.2.3 Tendencia con diferenciación\nEn la Figura 2.7 se presentan los gráficos de las series sin tendencia, estimada con regresión lineal y con diferenciación respectivamente, se puede notar que la serie sin tendencia estimada con diferenciación impide ver los ciclos que se ven en la serie original.\n\ntsibble_energia&lt;-as_tsibble(energia2)\npar(mar = c(2,2,2,2))\npar(mfrow=c(2,1))\n\nplot(resid(fit_e), type=\"l\", main=\"Sin tendencia\") \nplot(diff(energia2), type=\"l\", main=\"Primera Diferencia\") \n\n\n\n\nFigura 2.7: Gráfico de la serie de tiempo de la energía sin tendencia estimada con regresión lineal y diferenciación.\n\n\n\n\n\n\n2.2.4 Comparación de los ACF\nEn la Figura 2.8 se puede notar un descenso rápido hacia 0 para las series original y sin tendencia estimada con regresión lineal, mientras que para la serie sin tendencia estimada con diferenciación, se puede apreciar mejor el ciclo estacional de aproximadamente 7 días.\n\n# Gráficos de los ACF\npar(mar = c(3,2,3,2))\npar(mfrow=c(3,1))\nacf(energia2, 60, main=\"ACF energia\")\nacf(resid(fit_e), 60, main=\"ACF Sin tendencia\") \nacf(diff(energia2), 60, main=\"ACF Primera Diferencia\")\n\n\n\n\nFigura 2.8: Gráficos de autocorrelación para la serie original, sin tendencia estimada con regresión lineal y con la primera diferencia."
  },
  {
    "objectID": "Descriptivo Energia.html#estimación-de-la-estacionalidad",
    "href": "Descriptivo Energia.html#estimación-de-la-estacionalidad",
    "title": "2  Análisis del consumo de energía de la empresa PJM",
    "section": "2.3 Estimación de la estacionalidad",
    "text": "2.3 Estimación de la estacionalidad\n\n2.3.0.1 Detección de estacionalidad\n\n# Gráfica de retardos\npar(mar = c(3, 2, 3, 2))\nastsa::lag1.plot(energia2, 7,corr=F)\n\n\n\nastsa::lag1.plot(diff(energia2), 7,corr=F)\n\n\n\n\n\n# Indice AMI \ntseriesChaos::mutual(energia2, partitions = 50, lag.max = 10, plot=TRUE) \n\n\n\n\n\n#energia_df&lt;-energia\n#energia_df$time = as.POSIXct(energia_df$fecha, \"%Y-%m-%d\")\n#energia_df$weekday &lt;- wday(energia_df$time, label = TRUE, abbr = TRUE)\n#energia_df$month &lt;- factor(month.abb[month(energia_df$time)], levels =   month.abb)\nenergiasss&lt;-rbind(energia,c(\"2018-08-03\",0))\nenergia_df1&lt;-energiasss\nenergia_df1$time = as.POSIXct(energia_df1$fecha, \"%Y-%m-%d\")\nenergia_df&lt;-cbind(energia_df1[1:5054,1:2],energia_df1[2:5055,3])\n\nenergia_df$weekday &lt;- wday(energia_df$time, label = TRUE, abbr = TRUE)\n\nWarning in as.POSIXlt.POSIXct(x, tz = tz(x)): unknown timezone '%Y-%m-%d'\n\nenergia_df$month &lt;- factor(month.abb[month(energia_df$time)], levels =   month.abb)\n\nWarning in as.POSIXlt.POSIXct(x, tz = tz(x)): unknown timezone '%Y-%m-%d'\n\nhead(energia_df)\n\nWarning in as.POSIXlt.POSIXct(x, tz): unknown timezone '%Y-%m-%d'\n\n\n       fecha Energia       time weekday month\n1 2004-10-01  254046 2004-10-02  sáb\\\\.   Oct\n2 2004-10-02  318280 2004-10-03  dom\\\\.   Oct\n3 2004-10-03  293620 2004-10-04  lun\\\\.   Oct\n4 2004-10-04  333971 2004-10-05  mar\\\\.   Oct\n5 2004-10-05  347423 2004-10-06  mié\\\\.   Oct\n6 2004-10-06  347392 2004-10-07  jue\\\\.   Oct\n\ntail(energia_df)\n\nWarning in as.POSIXlt.POSIXct(x, tz): unknown timezone '%Y-%m-%d'\n\n\n          fecha Energia       time weekday month\n5049 2018-07-28  345439 2018-07-29  dom\\\\.   Jul\n5050 2018-07-29  326291 2018-07-30  lun\\\\.   Jul\n5051 2018-07-30  362481 2018-07-31  mar\\\\.   Jul\n5052 2018-07-31  367135 2018-08-01  mié\\\\.   Aug\n5053 2018-08-01  363979 2018-08-02  jue\\\\.   Aug\n5054 2018-08-02  371807 2018-08-03  vie\\\\.   Aug\n\n\n\n#energia_df%&gt;%plot_seasonal_diagnostics(.date_var = time,.value = Energia,.feature_set = c(\"wday.lbl\"),.geom=\"boxplot\")\n#energia_df%&gt;%plot_seasonal_diagnostics(.date_var = time,.value = Energia,.feature_set = c(\"month.lbl\"),.geom=\"boxplot\")\n\n# Gráfica de subseries semanal con datos originales\ngg_subseries(tsbl_energia,y=Energia,period=7)\n\n\n\n\n\n# Gráfica de subseries anual con datos originales\ngg_subseries(tsbl_energia,y=Energia,period=12)\n\n\n\n\n\n# Periodograma Datos originales\nspectrum(as.numeric(energia2),log='no')\n\nPeriodogramaEnergia2=spectrum(as.numeric(energia2),log='no')\n\n\n\nubicacionenergia=which.max(PeriodogramaEnergia2$spec)\n\nsprintf(\"El valor de la frecuencia donde se maximiza el periodograma para la serie es: %s\",PeriodogramaEnergia2$freq[ubicacionenergia])\n\n[1] \"El valor de la frecuencia donde se maximiza el periodograma para la serie es: 0.00546875\"\n\nsprintf(\"El periodo correspondiente es aproximadamente: %s\",1/PeriodogramaEnergia2$freq[ubicacionenergia])\n\n[1] \"El periodo correspondiente es aproximadamente: 182.857142857143\"\n\n\n\n# Periodograma sin tendencia lineal\nspectrum(as.numeric(ElimiTendenerg),log='no')\n\nPeriodogramaEnergia2_lineal=spectrum(as.numeric(ElimiTendenerg),log='no')\n\n\n\nubicacionlogenergia=which.max(PeriodogramaEnergia2_lineal$spec)\n\nsprintf(\"El valor de la frecuencia donde se maximiza el periodograma para la serie es: %s\",PeriodogramaEnergia2_lineal$freq[ubicacionlogenergia])\n\n[1] \"El valor de la frecuencia donde se maximiza el periodograma para la serie es: 0.00546875\"\n\nsprintf(\"El periodo correspondiente es aproximadamente: %s\",1/PeriodogramaEnergia2_lineal$freq[ubicacionlogenergia])\n\n[1] \"El periodo correspondiente es aproximadamente: 182.857142857143\"\n\n\n\n# Periodograma diferenciación\nspectrum(as.numeric(diff(energia2)),log='no')\n\nPeriodogramaEnergia2_dif=spectrum(as.numeric(diff(energia2)),log='no')\n\n\n\nubicacionlogenergia=which.max(PeriodogramaEnergia2_dif$spec)\n\nsprintf(\"El valor de la frecuencia donde se maximiza el periodograma para la serie es: %s\",PeriodogramaEnergia2_dif$freq[ubicacionlogenergia])\n\n[1] \"El valor de la frecuencia donde se maximiza el periodograma para la serie es: 0.2857421875\"\n\nsprintf(\"El periodo correspondiente es aproximadamente: %s\",1/PeriodogramaEnergia2_dif$freq[ubicacionlogenergia])\n\n[1] \"El periodo correspondiente es aproximadamente: 3.49965823650034\"\n\n\n\n\n2.3.0.2 Desestacionalización\n\ns=1/PeriodogramaEnergia2$freq[ubicacionenergia]\n\nsin_est=diff(energia2,lag=round(s),differences=1)\n\nplot.ts(sin_est, main=\"Serie sin estacionalidad\", ylab='')\n\n\n\n\nPreguntar: Cuando lo hacemos con lenergia se veia que no habia tendencia, pero ahorita con los datos originales no, por la escala parece haber tendencia, y mirando el ACF se nota mucho la estacionalidad estimandola con diferenciacion"
  }
]